<?php      class Live extends CI_Controller{          function index()          {  			//$this->load->model('live_model'); 			/*$data = array(                   'username'  => 'Ahmed',                   'loged'  => TRUE                );                $this->session->set_userdata($data);			*/			if($this->session->userdata('username')  == TRUE)			{				$data['username'] = $this->session->userdata('username');				$data['page'] = 'signup_view.php';				$this->load->view('live_view',$data);			}else 			{				$data['page'] = 'signup_view.php';				$this->load->view('live_view',$data);			}			//$this->load->view('signup_view');						//$this->load->model('live_model'); 			//echo $this->live_model->get_channel_type_byname('free');						//$arr['name'] = "CH2";			//$arr['disc'] = "DESC2";			//$arr['creation_date'] = time();				//$this->live_model->insert_channel($arr);						/*				$arr['first_name']="ahmed";				$arr['last_name']="essam";				$arr['username']="eradas";				$arr['password']="1234";				$arr['email']="era@yahoo.com";				$arr['country_id']=1;//$this->input->post('country_id');				$arr['reg_date']=time();				$arr['sex']=0;				$arr['last_login_date']=time();				$this->live_model->insert_user($arr);			*/					//$this->live_model->update_user(2,$arr);								//echo $this->live_model->get_channel_id_byname("CH1");						        }		function checklogin()		{			$this->load->model('live_model'); 			$this->load->library('session');						$a['username'] = $this->input->post('username');			$a['password'] = $this->input->post('password');			$username = $a['username'];			$ret = $this->live_model->login($a) ;			if($ret != -1)			{			$uid = $this->live_model->get_userid_byname($username);			$data = array(                   'username'  => $username,				   'user_id' => $uid,                   'logged'  => TRUE                );                $this->session->set_userdata($data);				$da['page'] = 'welcome.php';				$da['username'] = $username;				$this->load->view('live_view',$da);				return;			}			else echo 'bad password';			$this->load->view('done_view');			return;		}		function logout()		{			$this->session->sess_destroy();			$da['page'] = 'signup_view.php';			$this->load->view('live_view',$da);		}		function newUser()		{		//------------- insert new user ----------------//			$this->load->model('live_model'); 						$arr['first_name']=$this->input->post('first_name');			$arr['last_name']=$this->input->post('last_name');			$arr['username']=$this->input->post('username');			$arr['password']=$this->input->post('password');			$arr['email']=$this->input->post('email');			$arr['country_id']=1;//$this->input->post('country_id');			$arr['reg_date']=time();			$arr['sex']=0;			$arr['last_login_date']=time();			$this->live_model->insert_user($arr);						$uid = $this->live_model->get_userid_byname($arr['username']);			$da = array(				'username' => $arr['username'],				'user_id' => $uid,				'logged' => true				);			$this->session->set_userdata($da);						$data['page'] = 'create_channel_view.php';			$data['user_id'] = $uid;			$this->load->view('live_view',$data);		} 		function createChannel()		{			$this->load->model('live_model');			$arr['name'] = $this->input->post('channel_name');			$arr['user_id'] = $this->session->userdata('user_id');			$arr['disc'] = $this->input->post('channel_disc');			$arr['creation_date'] = time();				$this->live_model->insert_channel($arr);						//$data['page'] = 'live_view.php';			//$data['user_id'] = $this->session->userdata('user_id');			$this->load->view('done_view',$data);		}		function upload()		{			$this->load->model('live_model'); 			$x = $this->session->userdata('user_id');			if($x != 0)			{				$channel_id = $this->live_model->get_channelid_byuserid($x);								$da = array(					'channel_id' => $channel_id						);					$this->session->set_userdata($da);									$data['page'] = 'upload_video.php';					$data['username'] = $this->session->userdata('username');					$this->load->view('live_view',$data);			}		}		function welcome()		{			$this->load->model('live_model'); 			$x = $this->session->userdata('user_id');			echo $x;		}		function do_upload2()		{			$uploaddir = 'uploads/';			$fname = $_FILES['fx'];			if (is_uploaded_file($fname['tmp_name']))			{			$filname = basename($fname['name']);			$uploadfile = $uploaddir . basename($fname['name']);						if (move_uploaded_file ($fname['tmp_name'], $uploadfile))			{			//$res = "File " . $filname . " was successfully uploaded and stored.<br>";				$this->load->model('live_model');				$arr['name'] = $this->input->post('name');				$arr['channel_id'] = $this->session->userdata('channel_id');				$arr['view'] = 1;				$arr['date'] = time();				$arr['desc'] = $this->input->post('desc');				$arr['access_id'] = 1;				$arr['link'] = $uploadfile;				$this->live_model->insert_video($arr);								$this->show($uploadfile);				return;				$data['username'] = $this->session->userdata('username');                $data['page'] = 'welcome.php';				$this->load->view('live_view',$data);				return;			}			else			$res = "Could not move ".$fname['tmp_name']." to ".$uploadfile."<br>";			}			else			$res = "File ".$fname['name']." failed to upload.";			echo ($res);		}		function show($id)		{			$this->load->model('live_model');			$data['filepath']=$id;//$this->live_model->get_videolink_byid($id);			if($this->session->userdata('username')  == TRUE)				$data['username'] = $this->session->userdata('username');			else 				$data['page'] = 'signup_view.php';				$data['page'] = 'show.php';			$this->load->view('live_view',$data);		}						//------------ADD RATE FUNCTION----------------//				function add_rate()		{			$this->load->model('live_model'); 									$arr['video_id']=1;//$this->input->post('video_id');			$arr['user_id']=1;//$this->input->post('user_id');			$arr['value']=$this->input->post('value');						$this->live_model->insert_rate($arr) ;  			$this->load->view('done_view');        }		function new_comment()		{			$this->load->model('live_model'); 						$arr['email'] = $this->input->post('email');			$arr['username'] = $this->input->post('username');			$arr['text'] = $this->input->post('text');			$arr['date'] = time();			$arr['video_id'] = 1;			$this->live_model->insert_comment($arr);		}				    }  